<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebSocket Test</title>
</head>
<body>
<h1>WebSocket 연결 테스트</h1>
<div id="messages"></div>

<script>
  // WebSocket 연결
  const socket = new WebSocket("ws://localhost:8080/ws/conn");

  // 연결 성공 시
  socket.onopen = function(event) {
    console.log("WebSocket 연결 성공");
    document.getElementById("messages").innerHTML = "WebSocket 연결 성공";
  };

  // 서버로부터 메시지 수신 시
  socket.onmessage = function(event) {
    console.log("서버로부터 메시지 수신:", event.data);
    document.getElementById("messages").innerHTML += `<p>${event.data}</p>`;
  };

  // WebSocket 에러 처리
  socket.onerror = function(error) {
    console.log("WebSocket 에러:", error);
    document.getElementById("messages").innerHTML += "<p>WebSocket 에러 발생</p>";
  };

  // WebSocket 연결 종료 시
  socket.onclose = function(event) {
    console.log("WebSocket 연결 종료:", event);
    document.getElementById("messages").innerHTML += "<p>WebSocket 연결 종료</p>";
  };

  // WebSocket 연결 종료 함수
  function closeWebSocketConnection() {
    if (socket.readyState === WebSocket.OPEN) {
      socket.close();  // WebSocket 연결 종료
      console.log("WebSocket 연결 종료");
    } else {
      console.log("WebSocket 연결이 이미 종료되었습니다.");
    }
  }
</script>

<button onclick="closeWebSocketConnection()">WebSocket 연결 종료</button>
</body>
</html>
